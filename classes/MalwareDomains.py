class MalwareDomains:
    def __init__(self, path):
        self.__mal_domains_dict = dict()
        # TODO: Get this remotely from a malwaredomains mirror

        with open(path, "r") as f:
            for row in f:
                row = row.rstrip()
                mal_entry = dict()
                mal_entry['dom_name'] = row
                mal_entry["length"] = len(row)
                if mal_entry['dom_name'] not in self.__mal_domains_dict:
                    self.__mal_domains_dict[row] = mal_entry

    def score(self, domain):
        # Try to get an entry from the malwaredomains hashmap using
        # domain as the key.
        entry = self.__mal_domains_dict.get(domain.domain, None)
        domain.set_subscore("malwaredomains",
                            {"score": (entry is not None)})
        return entry is not None
